 	         <!-- Toggles -->
<input class="npcship_toggle" name="attr_npcship_toggle" type="hidden" value="0">
<input class="npcship_toggle" name="attr_npcship_toggle" type="hidden" value="1">
<input class="npcship_toggle" name="attr_npcship_toggle" type="hidden" value="2">
<!-- Containers -->
<div class="container npc">
    
</div>
<div class="container pc">
    <div class='name-container'>
        <img class='header-image' src='https://s3.amazonaws.com/files.d20.io/images/37233401/rLKhHmqX51cO05GJ9r0BpA/max.png'>
    </div>
    <!--<div class='header'>-->
        <input class='char-tab char-details-tab' name='char-tab' type='radio' value='char info' checked='checked'><h1 class='section label char-details' data-i18n='character_info'>CHARACTER INFO</h1>
        <div class='header-content char-info'>
            <div class='hlabel-container'>
                <input class='char-name' type="text" name="attr_character_name">
                <span class="label" data-i18n="char-name-u">CHARACTER NAME</span>
            </div>
            <div class='hlabel-container class-level'>
                <input class='class-level' type='text' readonly='true' name='attr_class&level' title='@{class&level}'>
                <span class='label' data-i18n='class-level'>CLASS/LEVEL</span>
            </div>
            <div class='hlabel-container'>
                <input class='race' type='text' name='attr_race' title='@{race}'>
                <span class='label' data-i18n='race'>RACE</span>
            </div>
            <div class='hlabel-container'>
                <input class='race-hp' type='text' name='attr_race_hp' title='@{race_hp}'>
                <span class='label' data-i18n='hp'>HP</span>
            </div>
            <div class='hlabel-container'>
                <input class='theme' type='text' name='attr_theme' title='@{theme}'>
                <span class='label' data-i18n='theme'>THEME</span>
            </div>
            <div class='hlabel-container'>
                <select class='size' name='attr_size' title=@{size}>
                    <option value='-4'>FINE</option>
                    <option value='-3'>DIMINUTIVE</option>
                    <option value='-2'>TINY</option>
                    <option value='-1'>SMALL</option>
                    <option value='0'selected='selected'>MEDIUM</option>
                    <option value='1'>LARGE</option>
                    <option value='2'>HUGE</option>
                    <option value='3'>GARGANTUAN</option>
                    <option value='4'>COLOSSAL</option>
                </select>
                <span class='label' data-i18n='size'>SIZE</span>
            </div>
            <div class='hlabel-container'>
                <input class=speed type='text' name='attr_speed' title='@{speed}'>
                <span class='label' data-i18n='speed'>SPEED</span>
            </div>
            <div class='hlabel-container'>
                <input class=gender type='text' name='attr_gender' title='@{gender}'>
                <span class='label' data-i18n='gender'>GENDER</span>
            </div>
            <div class='hlabel-container'>
                <input class='home-world' type='text' name='attr_home_world' title='@{home_world}'>
                <span class='label' data-i18n='home-world'>HOME WORLD</span>
            </div>
            <div class='hlabel-container'>
                <input class=alignment type='text' name='attr_alignment' title='@{alignment}'>
                <span class='label' data-i18n='alignment'>ALIGNMENT</span>
            </div>
            <div class='hlabel-container'>
                <input class=deity type='text' name='attr_deity' title='@{deity}'>
                <span class='label' data-i18n='deity'>DEITY</span>
            </div>
            <div class='hlabel-container'>
                <input class=language type='text' name='attr_language' title='@{language}'>
                <span class='label' data-i18n='languages'>LANGUAGES</span>
            </div>
            <div class='hlabel-container'>
                <input class=player type='text' name='attr_player' title='@{player}'>
                <span class='label' data-i18n='player'>PLAYER</span>
            </div>
        </div>
        <input class='char-tab class-details-tab' name='char-tab' type='radio' value='class details'><h1 class='section label class-details' data-i18n='class-details'>CLASS DETAILS</h1>
        <div class='header-content class-info'>
            <span class='label class-name' data-i18n='class-name'>CLASS NAME</span>
            <span class='label class-num-level' data-i18n='class-num-level'>LVL</span>
            <span class='label class-health' data-i18n='class-stam'>SP</span>
            <span class='label class-health' data-i18n='hp'>HP</span>
            <span class='label class-bab' data-i18n='bab'>BAB</span>
            <span class='label class-save' data-i18n='fort'>FORT</span>
            <span class='label class-save' data-i18n='ref'>REF</span>
            <span class='label class-save' data-i18n='will'>WILL</span>
            <span class='label class-skills' data-i18n='skills'>SKILLS</span>
            <span class='label class-ability' data-i18n='abi'>ABI</span>
            <input class='class-name' type='text' name='attr_class-1-name' title='@{class-1-name}' placeholder='1st Class'>
            <input class='class-num-level' type='text' name='attr_class-1-level' title='@{class-1-level}' placeholder='1'>
            <input class='class-health' type='text' name='attr_class-1-sp' title='@{class-1-sp}' placeholder='4'>
            <input class='class-health' type='text' name='attr_class-1-hp' title='@{class-1-hp}' placeholder='4'>
            <select class='class-bab' name='attr_class-1-bab' title=@{class-1-bab}>
                <option value='0.5'>1/2</option>
                <option value='0.75'>3/4</option>
                <option value='1'>1</option>
            </select>
            <select class='class-save' name='attr_class-1-fort'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-1-ref'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-1-will'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <input class='class-skills' type='text' name='attr_class-1-skills' title='@{class-1-skills}' placeholder='4'>
            <select class='class-ability' name='attr_class-1-ability' placeholder='@{class-1-ability}'>
                <option value='strength_mod'>STR</option>
                <option value='dexterity_mod' selected='selected'>DEX</option>
                <option value='constitution_mod'>CON</option>
                <option value='intelligence_mod'>INT</option>
                <option value='wisdom_mod'>WIS</option>
                <option value='charisma_mod'>CHA</option>
            </select>
            <input class='class-name' type='text' name='attr_class-2-name' title='@{class-2-name}' placeholder='2nd Class'>
            <input class='class-num-level' type='text' name='attr_class-2-level' title='@{class-2-level}' placeholder='1'>
            <input class='class-health' type='text' name='attr_class-2-sp' title='@{class-2-sp}' placeholder='4'>
            <input class='class-health' type='text' name='attr_class-2-hp' title='@{class-2-hp}' placeholder='4'>
            <select class='class-bab' name='attr_class-2-bab' title=@{class-2-bab}>
                <option value='0.5'>1/2</option>
                <option value='0.75'>3/4</option>
                <option value='1'>1</option>
            </select>
            <select class='class-save' name='attr_class-2-fort'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-2-ref'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-2-will'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <input class='class-skills' type='text' name='attr_class-2-skills' title='@{class-2-skills}' placeholder='4'>
            <select class='class-ability' name='attr_class-2-ability' placeholder='@{class-2-ability}'>
                <option value='strength_mod'>STR</option>
                <option value='dexterity_mod' selected='selected'>DEX</option>
                <option value='constitution_mod'>CON</option>
                <option value='intelligence_mod'>INT</option>
                <option value='wisdom_mod'>WIS</option>
                <option value='charisma_mod'>CHA</option>
            </select>
            <input class='class-name' type='text' name='attr_class-3-name' title='@{class-3-name}' placeholder='3rd Class'>
            <input class='class-num-level' type='text' name='attr_class-3-level' title='@{class-3-level}' placeholder='1'>
            <input class='class-health' type='text' name='attr_class-3-sp' title='@{class-3-sp}' placeholder='4'>
            <input class='class-health' type='text' name='attr_class-3-hp' title='@{class-3-hp}' placeholder='4'>
            <select class='class-bab' name='attr_class-3-bab' title=@{class-3-bab}>
                <option value='0.5'>1/2</option>
                <option value='0.75'>3/4</option>
                <option value='1'>1</option>
            </select>
            <select class='class-save' name='attr_class-3-fort'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-3-ref'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-3-will'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <input class='class-skills' type='text' name='attr_class-3-skills' title='@{class-3-skills}' placeholder='4'>
            <select class='class-ability' name='attr_class-3-ability' placeholder='@{class-3-ability}'>
                <option value='strength_mod'>STR</option>
                <option value='dexterity_mod' selected='selected'>DEX</option>
                <option value='constitution_mod'>CON</option>
                <option value='intelligence_mod'>INT</option>
                <option value='wisdom_mod'>WIS</option>
                <option value='charisma_mod'>CHA</option>
            </select>
            <input class='class-name' type='text' name='attr_class-4-name' title='@{class-4-name}' placeholder='4th Class'>
            <input class='class-num-level' type='text' name='attr_class-4-level' title='@{class-4-level}' placeholder='1'>
            <input class='class-health' type='text' name='attr_class-4-sp' title='@{class-4-sp}' placeholder='4'>
            <input class='class-health' type='text' name='attr_class-4-hp' title='@{class-4-hp}' placeholder='4'>
            <select class='class-bab' name='attr_class-4-bab' title=@{class-4-bab}>
                <option value='0.5'>1/2</option>
                <option value='0.75'>3/4</option>
                <option value='1'>1</option>
            </select>
            <select class='class-save' name='attr_class-4-fort'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-4-ref'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-4-will'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <input class='class-skills' type='text' name='attr_class-4-skills' title='@{class-4-skills}' placeholder='4'>
            <select class='class-ability' name='attr_class-4-ability' placeholder='@{class-4-ability}'>
                <option value='strength_mod'>STR</option>
                <option value='dexterity_mod' selected='selected'>DEX</option>
                <option value='constitution_mod'>CON</option>
                <option value='intelligence_mod'>INT</option>
                <option value='wisdom_mod'>WIS</option>
                <option value='charisma_mod'>CHA</option>
            </select>
            <input class='class-name' type='text' name='attr_class-5-name' title='@{class-5-name}' placeholder='5th Class'>
            <input class='class-num-level' type='text' name='attr_class-5-level' title='@{class-5-level}' placeholder='1'>
            <input class='class-health' type='text' name='attr_class-5-sp' title='@{class-5-sp}' placeholder='4'>
            <input class='class-health' type='text' name='attr_class-5-hp' title='@{class-5-hp}' placeholder='4'>
            <select class='class-bab' name='attr_class-5-bab' title=@{class-5-bab}>
                <option value='0.5'>1/2</option>
                <option value='0.75'>3/4</option>
                <option value='1'>1</option>
            </select>
            <select class='class-save' name='attr_class-5-fort'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-5-ref'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <select class='class-save' name='attr_class-5-will'>
                <option value='poor' data-i18n='poor' selected='selected'>POOR</option>
                <option value='good' data-i18n='good'>GOOD</option>
            </select>
            <input class='class-skills' type='text' name='attr_class-5-skills' title='@{class-5-skills}' placeholder='4'>
            <select class='class-ability' name='attr_class-5-ability' placeholder='@{class-5-ability}'>
                <option value='strength_mod'>STR</option>
                <option value='dexterity_mod' selected='selected'>DEX</option>
                <option value='constitution_mod'>CON</option>
                <option value='intelligence_mod'>INT</option>
                <option value='wisdom_mod'>WIS</option>
                <option value='charisma_mod'>CHA</option>
            </select>
        </div>
    <!--</div><!-- end of header div -->
    <!--<div class='in-play'>-->
        <input class='in-play-tab menu-tab' type='radio' name='attr_in-play-tab' value='menus' checked='checked'><h1 class='section label menu-head' data-i18n='menus'>MENUS</h1>
        <div class='menus in-play'>
            <button type='roll' name='roll_initiative' value='MACRO NEEDED' data-i18n='initiative'>INITIATIVE</button>
            <button type='roll' name='roll_attacks' value='MACRO NEEDED' data-i18n='attacks'>ATTACKS</button>
            <button type='roll' name='roll_saves' value='MACRO NEEDED' data-i18n='saves'>SAVES</button>
            <button type='roll' name='roll_spells' value='MACRO NEEDED' data-i18n='spells'>SPELLS</button>
            <button type='roll' name='roll_abilities' value='MACRO NEEDED' data-i18n='abilities-u'>ABILITIES</button>
            <button type='roll' name='roll_ability_checks' value='MACRO NEEDED' data-i18n='ability_checks'>ABILITY CHECKS</button>
        </div>
        <input class='in-play-tab buff-tab' type='radio' name='attr_in-play-tab' value='buffs'><h1 class='section label buff-head' data-i18n='buffs'>BUFFS</h1>
        <div class='buffs in-play'>
            
        </div>
    <!--</div>-->
    <div class=tab-container>
        <input class="tab-button core" type="radio" name="attr_tab" value="core" checked="checked"><span data-i18n="core">CORE</span>
        <input class="tab-button bio" type="radio" name="attr_tab" value="bio"><span data-i18n="bio">BIO</span>
        <input class="tab-button abilities" type="radio" name="attr_tab" value="abilities"><span data-i18n="abilities-u">ABILITIES</span>
        <input class="tab-button spells" type="radio" name="attr_tab" value="spells"><span data-i18n="spells">SPELLS</span>
        <input class="tab-button options" type="radio" name="attr_tab" value="options"><span style="font-family: pictos">y</span>
        <div class='page core'>
            <div class='attribute-container section-container'>
                <h1 class='section label' data-i18n='ability_scores'>ABILITY SCORES</h1>
                <div class='attr-container'>
                    <span class='button'></span>
                    <span class='mod'></span>
                    <span class='attr-total-container'></span>
                    <span class='label pen' data-i18n='pen'>PEN</span>
                    <span class='label drain' data-i18n='drain'>DRAIN</span>
                </div>
                <div class='attr-container'>
                    <button class='button' type='roll' name='roll_strength' value='MACRO NEEDED' data-i18n='strength' title=%{strength}>STRENGTH</button>
                    <input class='mod' type='text' name='attr_strength_mod' readonly='true' title='@{strength_mod}' value='0'>
                    <div class='attr-total-container'>
                        <input class='base-attr attr' type='number' name='attr_strength_base' value='10' title='@{strength}'>
                        <input class='mod-debuff' type='radio' name='attr_strength_change' value='-1' hidden='true'>
                        <input class='mod-normal' type='radio' name='attr_strength_change' value='0' hidden='true' checked='checked'>
                        <input class='mod-buff' type='radio' name='attr_strength_change' value='1' hidden='true'>
                        <span class='modified-attr attr' readonly='true' type='number' name='attr_strength' value='10'>10</span>
                    </div>
                    <input class='pen' type='number' name='attr_strength_penalty' value='' title='@{strength_penalty}'>
                    <input class='drain' type='number' name='attr_strength_drain' value='' title='@{strength_drain}'>
                </div>
                <div class='attr-container'>
                    <button class='button' type='roll' name='roll_dexterity' value='MACRO NEEDED' data-i18n='dexterity' title=%{dexterity}>DEXTERITY</button>
                    <input class='mod' type='text' name='attr_dexterity_mod' readonly='true' title='@{dexterity_mod}' value='0'>
                    <div class='attr-total-container'>
                        <input class='base-attr attr' type='number' name='attr_dexterity_base' value='10' title='@{dexterity}'>
                        <input class='mod-debuff' type='radio' name='attr_dexterity_change' value='-1' hidden='true'>
                        <input class='mod-normal' type='radio' name='attr_dexterity_change' value='0' hidden='true' checked='checked'>
                        <input class='mod-buff' type='radio' name='attr_dexterity_change' value='1' hidden='true'>
                        <span class='modified-attr attr' readonly='true' type='number' name='attr_dexterity' value='10'>10</span>
                    </div>
                    <input class='pen' type='number' name='attr_dexterity_penalty' value='' title='@{dexterity_penalty}'>
                    <input class='drain' type='number' name='attr_dexterity_drain' value='' title='@{dexterity_drain}'>
                </div>
                <div class='attr-container'>
                    <button class='button' type='roll' name='roll_constitution' value='MACRO NEEDED' data-i18n='constitution' title=%{constitution}>CONSTITUTION</button>
                    <input class='mod' type='text' name='attr_constitution_mod' readonly='true' title='@{constitution_mod}' value='0' value='0'>
                    <div class='attr-total-container'>
                        <input class='base-attr attr' type='number' name='attr_constitution_base' value='10' title='@{constitution}'>
                        <input class='mod-debuff' type='radio' name='attr_constitution_change' value='-1' hidden='true'>
                        <input class='mod-normal' type='radio' name='attr_constitution_change' value='0' hidden='true' checked='checked'>
                        <input class='mod-buff' type='radio' name='attr_constitution_change' value='1' hidden='true'>
                        <span class='modified-attr attr' readonly='true' type='number' name='attr_constitution' value='10'>10</span>
                    </div>
                    <input class='pen' type='number' name='attr_constitution_penalty' value='' title='@{constitution_penalty}'>
                    <input class='drain' type='number' name='attr_constitution_drain' value='' title='@{constitution_drain}'>
                </div>
                <div class='attr-container'>
                    <button class='button' type='roll' name='roll_intelligence' value='MACRO NEEDED' data-i18n='intelligence' title=%{intelligence}>INTELLIGENCE</button>
                    <input class='mod' type='text' name='attr_intelligence_mod' readonly='true' title='@{intelligence_mod}' value='0'>
                    <div class='attr-total-container'>
                        <input class='base-attr attr' type='number' name='attr_intelligence_base' value='10' title='@{intelligence}'>
                        <input class='mod-debuff' type='radio' name='attr_intelligence_change' value='-1' hidden='true'>
                        <input class='mod-normal' type='radio' name='attr_intelligence_change' value='0' hidden='true' checked='checked'>
                        <input class='mod-buff' type='radio' name='attr_intelligence_change' value='1' hidden='true'>
                        <span class='modified-attr attr' readonly='true' type='number' name='attr_intelligence' value='10'>10</span>
                    </div>
                    <input class='pen' type='number' name='attr_intelligence_penalty' value='' title='@{intelligence_penalty}'>
                    <input class='drain' type='number' name='attr_intelligence_drain' value='' title='@{intelligence_drain}'>
                </div>
                <div class='attr-container'>
                    <button class='button' type='roll' name='roll_wisdom' value='MACRO NEEDED' data-i18n='wisdom' title=%{wisdom}>WISDOM</button>
                    <input class='mod' type='text' name='attr_wisdom_mod' readonly='true' title='@{wisdom_mod}' value='0'>
                    <div class='attr-total-container'>
                        <input class='base-attr attr' type='number' name='attr_wisdom_base' value='10' title='@{wisdom}'>
                        <input class='mod-debuff' type='radio' name='attr_wisdom_change' value='-1' hidden='true'>
                        <input class='mod-normal' type='radio' name='attr_wisdom_change' value='0' hidden='true' checked='checked'>
                        <input class='mod-buff' type='radio' name='attr_wisdom_change' value='1' hidden='true'>
                        <span class='modified-attr attr' readonly='true' type='number' name='attr_wisdom' value='10'>10</span>
                    </div>
                    <input class='pen' type='number' name='attr_wisdom_penalty' value='' title='@{wisdom_penalty}'>
                    <input class='drain' type='number' name='attr_wisdom_drain' value='' title='@{wisdom_drain}'>
                </div>
                <div class='attr-container'>
                    <button class='button' type='roll' name='roll_charisma' value='MACRO NEEDED' data-i18n='charisma' title=%{charisma}>CHARISMA</button>
                    <input class='mod' type='text' name='attr_charisma_mod' readonly='true' title='@{charisma_mod}' value='0'>
                    <div class='attr-total-container'>
                        <input class='base-attr attr' type='number' name='attr_charisma_base' value='10' title='@{charisma}'>
                        <input class='mod-debuff' type='radio' name='attr_charisma_change' value='-1' hidden='true'>
                        <input class='mod-normal' type='radio' name='attr_charisma_change' value='0' hidden='true' checked='checked'>
                        <input class='mod-buff' type='radio' name='attr_charisma_change' value='1' hidden='true'>
                        <span class='modified-attr attr' readonly='true' type='number' name='attr_charisma' value='10'>10</span>
                    </div>
                    <input class='pen' type='number' name='attr_charisma_penalty' value='' title='@{charisma_penalty}'>
                    <input class='drain' type='number' name='attr_charisma_drain' value='' title='@{charisma_drain}'>
                </div>
            </div>
            <div class='ac-container section-container'>
                <h1 class='section label' data-i18n='armorclass'>ARMOR CLASS</h1>
                <div class='armor-container'>
                    <span class='ac'></span>
                    <span class='label tot' data-i18n='total'>TOTAL</span>
                    <span class='label arm' data-i18n='armor'>ARMOR</span>
                    <span class='label abi'></span>
                </div>
                <div class='armor-container'>
                    <span class='label ac' data-i18n='eac'>EAC</span>
                    <input class='mod-debuff' type='radio' name='attr_eac_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_eac_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_eac_change' value='1' hidden='true'>
                    <span class='tot mod modified-attr' readonly='true' name='attr_eac' title='@{eac}' value='10'>10</span>
                    <input class='mod-debuff' type='radio' name='attr_eac_armor_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_eac_armor_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_eac_armor_change' value='1' hidden='true'>
                    <span class='arm mod modified-attr' readonly='true' name='attr_eac_armor' title='@{eac_armor}' value='0'>0</span>
                    <select class='label abi' name='attr_eac_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod' selected='selected'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='armor-container'>
                    <span class='label ac' data-i18n='kac'>KAC</span>
                    <input class='mod-debuff' type='radio' name='attr_kac_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_kac_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_kac_change' value='1' hidden='true'>
                    <span class='tot mod' readonly='true' name='attr_kac' title='@{kac}' value='10'>10</span>
                    <input class='mod-debuff' type='radio' name='attr_kac_armor_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_kac_armor_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_kac_armor_change' value='1' hidden='true'>
                    <span class='arm mod' readonly='true' name='attr_kac_armor' title='@{kac_armor}' value='0'>0</span>
                    <select class='label abi' name='attr_kac_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod' selected='selected'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='armor-container'>
                    <span class='label ac' data-i18n='cmd'>CMD</span>
                    <input class='mod-debuff' type='radio' name='attr_cmd_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_cmd_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_cmd_change' value='1' hidden='true'>
                    <span class='tot mod' readonly='true' name='attr_cmd' title='@{cmd}' value='18'>18</span>
                    <span class='arm'></span>
                    <span class='abi'></span>
                </div>
                <div class='armor-container'>
                    <span class='label dr-span' data-i18n='dr_resist'>DR/RESIST</span>
                    <input class='dr' type='text' name='attr_dr' title='@{dr}' placeholder='5/- Fire 5'>
                </div>
                <div class='armor-container'>
                    <textarea class='ac-notes' name='attr_ac_notes' title=@{ac_notes} placeholder='Notes'></textarea>
                </div>
            </div>
            <div class='saving-container section-container'>
                <h1 class='section label' data-i18n='savingthrows'>SAVING THROWS</h1>
                <span class='label base' data-i18n='base'>BASE</span>
                <span class='label abi'></span>
                <div class='save-container'>
                    <button type='roll' name='roll_fort' value='MACRO NEEDED' data-i18n='fort' title='%{fort}'>FORT</button>
                    <input class='mod-debuff' type='radio' name='attr_fort_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_fort_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_fort_change' value='1' hidden='true'>
                    <span class='mod tot' readonly='true' type='text' name='attr_fort' title=@{fort} value='0'>0</span>
                    <input class='label base mod' readonly='true' name='attr_fort_base' value='0'>
                    <select class='label abi' name='attr_fort_ability' style='width; .5em;'>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='strength_mod'>STR</option>
                        <option value='constitution_mod' selected='selected'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='save-container'>
                    <button type='roll' name='roll_ref' value='MACRO NEEDED' data-i18n='ref' title='%{ref}'>REF</button>
                    <input class='mod-debuff' type='radio' name='attr_ref_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_ref_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_ref_change' value='1' hidden='true'>
                    <span class='mod tot' readonly='true' type='text' name='attr_ref' title=@{ref} value='0'>0</span>
                    <input class='label base mod' readonly='true' name='attr_ref_base' value='0'>
                    <select class='label abi' name='attr_ref_ability' style='width; .5em;'>
                        <option value='dexterity_mod' selected='selected'>DEX</option>
                        <option value='strength_mod'>STR</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='save-container'>
                    <button type='roll' name='roll_will' value='MACRO NEEDED' data-i18n='will' title='%{will}'>WILL</button>
                    <input class='mod-debuff' type='radio' name='attr_will_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_will_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_will_change' value='1' hidden='true'>
                    <span class='mod tot' readonly='true' type='text' name='attr_will' title=@{will} value='0'>0</span>
                    <input class='label base mod' readonly='true' name='attr_will_base' value='0'>
                    <select class='label abi' name='attr_will_ability' style='width; .5em;'>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='strength_mod'>STR</option>
          	          <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod' selected='selected'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='save-container'>
                    <textarea name='attr_save_notes' title=@{save_notes} placeholder='Notes'></textarea>
                </div>
            </div>
            <div class='equipment section-container'>
                <h1 class='section label' data-i18n='equipment'>EQUIPMENT</h1>
                <input type='radio' name='attr_encumber_level' hidden='true' value='0' checked='checked'>
                <div class='bulk-container carried'>
                    <input class='number' name='attr_carried_bulk' readonly='true' title='@{carried_bulk}' value='0'>
                    <span class='label' data-i18n='carried'>CARRIED</span>
                </div>
                <input class='encumbered' type='radio' name='attr_encumber_level' hidden='true' value='1'>
                <div class='bulk-container encumber'>
                    <input class='number' name=attr_encumber_bulk readonly='true' title='@{encumber_bulk}' value='5'>
                    <span class='label' data-i18n='encumbered'>ENCUMBERED</span>
                </div>
                <input class='overburdened' type='radio' name='attr_encumber_level' hidden='true' value='2'>
                <div class='bulk-container overburden'>
                    <input class='number' name='attr_overburden_bulk' readonly='true' title='@{overburden_bulk}' value='10'>
                    <span class='label' data-i18n='overburdened'>OVERBURDENED</span>
                </div>
                <div class='credits-container credits'>
                    <input type='text' name='attr_credits' title=@{credits} value=0>
                    <span class='label' data-i18n='credits'>CREDITS</span>
                </div>
                <div class='credits-container wealth'>
                    <input class='number' name='attr_wealth' readonly='true' title=@{wealth} value='0'>
                    <span class='label' data-i18n='wealth'>WEALTH</span>
                </div>
                <div class='item-container'>
                    <div class="label item-name-col" data-i18n="item-name">ITEM NAME</div>
                    <fieldset class='repeating_item'>
                        <div class='item'>
                            <input class="show-options" type="checkbox" name="attr_show-options" checked="checked"><span>y</span>
                            <div class='item-options'>
                                <span class='label' data-i18n='name-u'>NAME</span>
                                <input class='item-name' type='text' name='attr_item_name' placeholder='Laser Pistol'>
                                <span class='label' data-i18n='item_bulk'>BULK</span>
                                <input class='item-bulk' type='text' name='attr_item_bulk' placeholder='1'>
                                <span class='label' data-i18n='item_cost'>COST</span>
                                <input class='item-cost' type='text' name='attr_item_cost' placeholder='1'>
                                <span class='label' data-i18n='item_quantity'>NUM</span>
                                <input class='item-quantity' type='text' name='attr_item_quantity' placeholder='1'>
                                <input class='item-mods' type='text' name='attr_item_mods' placeholder='+X EAC, +X Luck to Will'>
                                <select class='item-equip' name='attr_item_equipped' title='@{repeating_$X_item_equipped}'>
                                    <option value='equipped' selected='selected'>EQUIPPED</option>
                                    <option value='carried'>CARRIED</option>
                                    <option value='not carried'>NOT CARRIED</option>
                                </select>
                                <textarea class='item-description' name='attr_item_description' title='@{repeating_item_$X_item_description}' placeholder='Description'></textarea>
                            </div>
                            <div class='display'>
                            	<button class='summary' type='roll' name='roll_item'><input name='attr_item_name'></button>
                            </div>
                        </div>
                    </fieldset>
                </div>
            </div>
            <div class='initiative-container'>
                <button class='section label' type='roll' name='roll_initiative' value='MACRO NEEDED' data-i18n='initiative' title='%{initiative}'>INITIATIVE</button>
                <input class='mod-debuff' type='radio' name='attr_initiative_change' value='-1' hidden='true'>
                <input class='mod-normal' type='radio' name='attr_initiative_change' value='0' hidden='true' checked='checked'>
                <input class='mod-buff' type='radio' name='attr_initiative_change' value='1' hidden='true'>
                <span class='mod tot' readonly='true' type='text' name='attr_initiative' title=@{initiative} value='0'>0</span>
                <span class='arith'>=</span>
                <select class='label abi' name='attr_initiative_ability' style='width; .5em;'>
                    <option value='dexterity_mod' selected='selected'>DEX</option>
                	<option value='strength_mod'>STR</option>
                	<option value='constitution_mod'>CON</option>
                	<option value='intelligence_mod'>INT</option>
                	<option value='wisdom_mod'>WIS</option>
                	<option value='charisma_mod'>CHA</option>
                </select>
            </div>
            <input class='full-health' type='radio' name='attr_health_status' readonly='true' hidden='true' value='0' checked='checked'>
            <input class='no-sp' type='radio' name='attr_health_status' value='1' readonly='true' hidden='true'>
            <input class='no-hp' type='radio' name='attr_health_status' value='2' readonly='true' hidden='true'>
            <input class='no-rp' type='radio' name='attr_health_status' value='3' readonly='true' hidden='true'>
            <div class='health-resolve-container section-container'>
                <h1 class='section label' data-i18n='health'>HEALTH</h1>
                <div class='health-container'>
                    <span class='health-label label stamina' data-i18n='sp'>SP</span>
                    <span class='health-label label hp' data-i18n='hp'>HP</span>
                    <span class='health-label label resolve' data-i18n='rp'>RP</span>
                    <span class='health-label label temp' data-i18n='temp-hp'>TEMP</span>
                    <input class='current stamina' type='number' name='attr_sp' value='0' title=@{sp}>
                    <span class='slash stamina'>/</span>
                    <input class='mod-debuff' type='radio' name='attr_sp_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_sp_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_sp_change' value='1' hidden='true'>
                    <span class='max stamina' type='number' name='attr_sp_max' readonly='true' value='0' title='@{sp|max}'>0</span>
                    <input class='current hp' type='number' name='attr_hp' value='0' title=@{hp}>
                    <span class='slash hp'>/</span>
                    <input class='mod-debuff' type='radio' name='attr_hp_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_hp_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_hp_change' value='1' hidden='true'>
                    <span class='max hp' type='number' name='attr_hp_max' readonly='true' value='0' title=@{hp|max}>0</span>
                    <input class='current resolve' type='number' name='attr_rp' value='0' title=@{rp}>
                    <span class='slash resolve'>/</span>
                    <input class='mod-debuff' type='radio' name='attr_rp_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_rp_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_rp_change' value='1' hidden='true'>
                    <span class='max resolve' type='number' name='attr_rp_max' readonly='true' value='0' title=@{rp|max}>0</span>
                    <input class='current temp' type='number' name='attr_temp_hp' value='0' title=@{temp_hp}>
                    <span class='slash temp'>/</span>
                    <input class='mod-debuff' type='radio' name='attr_temp_hp_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_temp_hp_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_temp_hp_change' value='1' hidden='true'>
                    <span class='max temp' type='number' name='attr_temp_hp_max' readonly='true' value='0' title=@{temp_hp|max}>0</span>
                </div>
            </div>
            <div class='weapons section-container'>
                <h1 class='section label' data-i18n='attacks'>ATTACKS</h1>
                <div class='attack-header'>
                    <div class="label atk-name-col" data-i18n="name-u">NAME</div>
                    <div class='label atk-mod-col' data-i18n="atk-u">ATK</div>
                    <div class="label atk-dmg-col" data-i18n="dmg-type-u">DAMAGE/TYPE</div>
                </div>
                <fieldset class='repeating_attack'>
                	<div class='attack'>
                        <input class="show-options" type="checkbox" name="attr_show-options" checked="checked"><span>y</span>
                        <div class='atk-options'>
                            <div class='row'>
                            	<span class='label' data-i18n='name-u'>NAME</span>
                            	<input class='atk-name' type='text' name='attr_attack_name' placeholder='Laser Pistol'>
                            	<span class='label' data-i18n='atk_level'>LVL</span>
                            	<input class='atk-level' type='text' name='attr_attack_level' placeholder='1'>
                        	</div>
                        	<div class='row'>
                                <span class='label' data-i18n='atk-u'>ATK</span>
                            	<select class='label atk-ability abi' name='attr_attack_ability'>
                            	    <option value='' selected='selected'>N/A</option>
                                    <option value='strength_mod'>STR</option>
                                    <option value='dexterity_mod'>DEX</option>
                                    <option value='constitution_mod'>CON</option>
                                    <option value='intelligence_mod'>INT</option>
                                    <option value='wisdom_mod'>WIS</option>
                                    <option value='charisma_mod'>CHA</option>
                                </select>
                                <span class='arith'>+</span>
                                <input class='bab' name='attr_attack_bab' disabled='true' title='@{bab}' value='@{bab}'>
                                <span class='arith'>+</span>
                                <input class='atk-misc misc' type='text' name='attr_attack_bonus' placeholder='@{attr}/2 + ?{Query}'>
                                <span class='label' data-i18n='atk_range'>RNG</span>
                                <input class='atk-range' type='text' name='attr_attack_range' placeholder='30 ft'>
                            </div>
                            <div class='row'>
                                <span class='label' data-i18n='atk_dmg'>DMG</span>
                                <input class='dmg-dice' type='text' name=attr_attack_dmg_dice title='@{repeating_attack_$X_attack_dmg_dice}' placeholder='1d8'><span>+</span>
                                <select class='label atk-ability abi' name='attr_attack_dmg_ability'>
                                    <option value='' selected='selected'>N/A</option>
                                    <option value='strength_mod'>STR</option>
                                    <option value='dexterity_mod'>DEX</option>
                                    <option value='constitution_mod'>CON</option>
                                    <option value='intelligence_mod'>INT</option>
                                    <option value='wisdom_mod'>WIS</option>
                                    <option value='charisma_mod'>CHA</option>
                                </select>
                                <span class='arith'>+</span>
                                <input class='atk-damage' type='text' name='attr_attack_damage' placeholder='@{attr}/2 + ?{Query}'>
                            </div>
                            <div class='row'>
                                <span class='label' data-i18n='atk_type'>TYPE</span>
                                <input class='atk-type' type='text' name='attr_attack_type' placeholder='Fire'>
                                <span class='label' data-i18n='atk_crit_effect'>CRIT EFFECT</span>
                                <input class='atk-crit' type='text' name='attr_attack_crit' placeholder='Burn'>
                            </div>
                            <div class='row'>
                                <span class='label' data-i18n='atk_usage'>USAGE</span>
                                <input class='atk-usage' type='text' name='attr_attack_usage' placeholder='1 charge'>
                                <span class='label' data-i18n='atk_special'>SPECIAL</span>
                                <input class='atk-special' type='text' name='attr_attack_special' placeholder='heirloom'>
                            </div>
                            <div class='row'>
                                <textarea class='atk-description' name='attr_attack_description' title='@{repeatin_attack_$X_atk_description}' placeholder='Description'></textarea>
                            </div>
                        </div>
                        <div class='display'>
                            <button class='summary' type='roll' name='roll_atk'>
                                <input class='atk-name-col' name='attr_attack_name'>
                                <input class='mod-debuff' type='radio' name='attr_attack_total_change' value='-1' hidden='true'>
                                <input class='mod-normal' type='radio' name='attr_attack_total_change' value='0' hidden='true' checked='checked'>
                                <input class='mod-buff' type='radio' name='attr_attack_total_change' value='1' hidden='true'>
                                <span class='atk-mod-col modified-attr' name='attr_attack_total' value='0'>0</span>
                                <input class='mod-debuff' type='radio' name='attr_attack_dmg_total_change' value='-1' hidden='true'>
                                <input class='mod-normal' type='radio' name='attr_attack_dmg_total_change' value='0' hidden='true' checked='checked'>
                                <input class='mod-buff' type='radio' name='attr_attack_dmg_total_change' value='1' hidden='true'>
                                <span class='atk-dmg-col modified-attr' name='attr_attack_dmg_total' value='0'>0</span>
                            </button>
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class='skills-container section-container'>
                <h1 class='section label' data-i18n='skills'>SKILLS</h1>
                <div class='skill-container'>
                    <span class='label tot' data-i18n='total'>TOTAL</span>
                    <div class='arith'> </div>
                    <span class='label ranks' data-i18n='ranks'>RANKS</span>
                    <div class='arith'> </div>
                    <span class='label class-skill' data-i18n='class-skill'>CS</span>
                    <div class='arith'> </div>
                    <span class='label abi'></span>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_acrobatics' value='MACRO NEEDED' data-i18n='acrobatics' title='%{acrobatics}'>ACROBATICS</button>
                    <input class='mod-debuff' type='radio' name='attr_acrobatics_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_acrobatics_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_acrobatics_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_acrobatics' title='@{acrobatics}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_acrobatics_ranks' value='' title='@{acrobatics_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_acrobatics_class_skill' title='@{acrobatics_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_acrobatics_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod' selected='selected'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_athletics' value='MACRO NEEDED' data-i18n='athletics' title='%{athletics}'>ATHLETICS</button>
                    <input class='mod-debuff' type='radio' name='attr_athletics_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_athletics_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_athletics_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_athletics' title='@{athletics}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_athletics_ranks' value='' title='@{athletics_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_athletics_class_skill' title='@{athletics_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_athletics_ability' style='width; .5em;'>
                        <option value='strength_mod' selected='selected'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_bluff' value='MACRO NEEDED' data-i18n='bluff' title='%{bluff}'>BLUFF</button>
                    <input class='mod-debuff' type='radio' name='attr_bluff_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_bluff_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_bluff_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_bluff' title='@{bluff}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_bluff_ranks' value='' title='@{bluff_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_bluff_class_skill' title='@{bluff_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_bluff_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod' selected='selected'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_computers' value='MACRO NEEDED' data-i18n='computers' title='%{computers}'>COMPUTERS</button>
                    <input class='mod-debuff' type='radio' name='attr_computers_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_computers_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_computers_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_computers' title='@{computers}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_computers_ranks' value='' title='@{computers_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_computers_class_skill' title='@{computers_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_computers_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod' selected='selected'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_culture' value='MACRO NEEDED' data-i18n='culture' title='%{culture}'>CULTURE</button>
                    <input class='mod-debuff' type='radio' name='attr_culture_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_culture_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_culture_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_culture' title='@{culture}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_culture_ranks' value='' title='@{culture_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_culture_class_skill' title='@{culture_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_culture_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod' selected='selected'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_diplomacy' value='MACRO NEEDED' data-i18n='diplomacy' title='%{diplomacy}'>DIPLOMACY</button>
                    <input class='mod-debuff' type='radio' name='attr_diplomacy_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_diplomacy_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_diplomacy_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_diplomacy' title='@{diplomacy}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_diplomacy_ranks' value='' title='@{diplomacy_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_diplomacy_class_skill' title='@{diplomacy_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_diplomacy_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod' selected='selected'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_disguise' value='MACRO NEEDED' data-i18n='disguise' title='%{disguise}'>DISGUISE</button>
                    <input class='mod-debuff' type='radio' name='attr_disguise_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_disguise_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_disguise_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_disguise' title='@{disguise}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_disguise_ranks' value='' title='@{disguise_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_disguise_class_skill' title='@{disguise_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_disguise_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod' selected='selected'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_engineering' value='MACRO NEEDED' data-i18n='engineering' title='%{engineering}'>ENGINEERING</button>
                    <input class='mod-debuff' type='radio' name='attr_engineering_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_engineering_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_engineering_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_engineering' title='@{engineering}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_engineering_ranks' value='' title='@{engineering_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_engineering_class_skill' title='@{engineering_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_engineering_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod' selected='selected'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_intimidate' value='MACRO NEEDED' data-i18n='intimidate' title='%{intimidate}'>INTIMIDATE</button>
                    <input class='mod-debuff' type='radio' name='attr_intimidate_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_intimidate_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_intimidate_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_intimidate' title='@{intimidate}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_intimidate_ranks' value='' title='@{intimidate_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_intimidate_class_skill' title='@{intimidate_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_intimidate_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod' selected='selected'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_life_science' value='MACRO NEEDED' data-i18n='life_science' title='%{life_science}'>LIFE SCIENCE</button>
                    <input class='mod-debuff' type='radio' name='attr_life_science_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_life_science_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_life_science_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_life_science' title='@{life_science}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_life_science_ranks' value='' title='@{life_science_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_life_science_class_skill' title='@{life_science_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_life_science_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod' selected='selected'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_medicine' value='MACRO NEEDED' data-i18n='medicine' title='%{medicine}'>MEDICINE</button>
                    <input class='mod-debuff' type='radio' name='attr_medicine_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_medicine_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_medicine_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_medicine' title='@{medicine}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_medicine_ranks' value='' title='@{medicine_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_medicine_class_skill' title='@{medicine_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_medicine_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod' selected='selected'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_mysticism' value='MACRO NEEDED' data-i18n='mysticism' title='%{mysticism}'>MYSTICISM</button>
                    <input class='mod-debuff' type='radio' name='attr_mysticism_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_mysticism_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_mysticism_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_mysticism' title='@{mysticism}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_mysticism_ranks' value='' title='@{mysticism_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_mysticism_class_skill' title='@{mysticism_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_mysticism_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod' selected='selected'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_perception' value='MACRO NEEDED' data-i18n='perception' title='%{perception}'>PERCEPTION</button>
                    <input class='mod-debuff' type='radio' name='attr_perception_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_perception_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_perception_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_perception' title='@{perception}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_perception_ranks' value='' title='@{perception_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_perception_class_skill' title='@{perception_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_perception_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod' selected='selected'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_physical_science' value='MACRO NEEDED' data-i18n='physical_science' title='%{physical_science}'>PHSYICAL SCIENCE</button>
                    <input class='mod-debuff' type='radio' name='attr_physical_science_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_physical_science_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_physical_science_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_physical_science' title='@{physical_science}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_physical_science_ranks' value='' title='@{physical_science_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_physical_science_class_skill' title='@{physical_science_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_physical_science_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod' selected='selected'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_piloting' value='MACRO NEEDED' data-i18n='piloting' title='%{piloting}'>PILOTING</button>
                    <input class='mod-debuff' type='radio' name='attr_piloting_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_piloting_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_piloting_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_piloting' title='@{piloting}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_piloting_ranks' value='' title='@{piloting_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_piloting_class_skill' title='@{piloting_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_piloting_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod' selected='selected'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='profession-placeholder' data-i18n='profession_placeholder'>ADD PROFESSIONS HERE</div>
                <fieldset class='repeating_profession'>
                    <div class='skill-container'>
                        <button type='roll' name='roll_profession' value='MACRO NEEDED' data-i18n='profession' title='%{repeating_profession_$X_profession_roll}'>PROFESSION</button>
                        <input class='prof-name' type='text' name='attr_profession_name' placeholder='artist'>
                        <input class='mod-debuff' type='radio' name='attr_profession_change' value='-1' hidden='true'>
                        <input class='mod-normal' type='radio' name='attr_profession_change' value='0' hidden='true' checked='checked'>
                        <input class='mod-buff' type='radio' name='attr_profession_change' value='1' hidden='true'>
                        <span class='mod tot modified-attr' readonly='true' type='text' name='attr_profession' title='@{profession}' value='0'>0</span>
                        <div class='arith'>=</div>
                        <input class='ranks' type='number' name='attr_profession_ranks' value='' title='@{profession_ranks}'>
                        <div class='arith'>+</div>
                        <div class='class-skill'><input type='checkbox' name='attr_profession_class_skill' title='@{profession_class_skill}' value='3'><span class='cs'>3</span></div>
                        <div class='arith'>+</div>
                        <select class='label abi' name='attr_profession_ability' style='width; .5em;'>
                            <option value='strength_mod'>STR</option>
                            <option value='dexterity_mod'>DEX</option>
                            <option value='constitution_mod'>CON</option>
                            <option value='intelligence_mod' selected='selected'>INT</option>
                            <option value='wisdom_mod'>WIS</option>
                            <option value='charisma_mod'>CHA</option>
                        </select>
                    </div>
                </fieldset>
                <div class='skill-container'>
                    <button type='roll' name='roll_sense_motive' value='MACRO NEEDED' data-i18n='sense_motive' title='%{sense_motive}'>SENSE MOTIVE</button>
                    <input class='mod-debuff' type='radio' name='attr_sense_motive_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_sense_motive_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_sense_motive_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_sense_motive' title='@{sense_motive}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_sense_motive_ranks' value='' title='@{sense_motive_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_sense_motive_class_skill' title='@{sense_motive_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_sense_motive_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod' selected='selected'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_sleight_of_hand' value='MACRO NEEDED' data-i18n='sleight_of_hand' title='%{sleight_of_hand}'>SLEIGHT OF HAND</button>
                    <input class='mod-debuff' type='radio' name='attr_sleight_of_hand_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_sleight_of_hand_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_sleight_of_hand_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_sleight_of_hand' title='@{sleight_of_hand}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_sleight_of_hand_ranks' value='' title='@{sleight_of_hand_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_sleight_of_hand_class_skill' title='@{sleight_of_hand_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_sleight_of_hand_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod' selected='selected'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_stealth' value='MACRO NEEDED' data-i18n='stealth' title='%{stealth}'>STEALTH</button>
                    <input class='mod-debuff' type='radio' name='attr_stealth_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_stealth_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_stealth_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_stealth' title='@{stealth}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_stealth_ranks' value='' title='@{stealth_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_stealth_class_skill' title='@{stealth_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_stealth_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod' selected='selected'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <button type='roll' name='roll_survival' value='MACRO NEEDED' data-i18n='survival' title='%{survival}'>SURVIVAL</button>
                    <input class='mod-debuff' type='radio' name='attr_survival_change' value='-1' hidden='true'>
                    <input class='mod-normal' type='radio' name='attr_survival_change' value='0' hidden='true' checked='checked'>
                    <input class='mod-buff' type='radio' name='attr_survival_change' value='1' hidden='true'>
                    <span class='mod tot modified-attr' readonly='true' type='text' name='attr_survival' title='@{survival}' value='0'>0</span>
                    <div class='arith'>=</div>
                    <input class='ranks' type='number' name='attr_survival_ranks' value='' title='@{survival_ranks}'>
                    <div class='arith'>+</div>
                    <div class='class-skill'><input type='checkbox' name='attr_survival_class_skill' title='@{survival_class_skill}' value='3'><span class='cs'>3</span></div>
                    <div class='arith'>+</div>
                    <select class='label abi' name='attr_survival_ability' style='width; .5em;'>
                        <option value='strength_mod'>STR</option>
                        <option value='dexterity_mod'>DEX</option>
                        <option value='constitution_mod'>CON</option>
                        <option value='intelligence_mod'>INT</option>
                        <option value='wisdom_mod' selected='selected'>WIS</option>
                        <option value='charisma_mod'>CHA</option>
                    </select>
                </div>
                <div class='skill-container'>
                    <textarea name='attr_skill_notes' title='@{skill_notes}' placeholder='Notes'></textarea>
                </div>
            </div>
        </div>
	</div>
	<input name='attr_bab' type='text' hidden='true' readonly='true' value='0'>
    <input name='attr_level' type='text' hidden='true' readonly='true' value='0'>
</div>
<div class="container ship">
    
</div>
<script type='text/worker'>
    /* ---- BEGIN: TheAaronSheet.js ---- */
    // Github:   https://github.com/shdwjk/TheAaronSheet/blob/master/TheAaronSheet.js
    // By:       The Aaron, Arcane Scriptomancer
    // Contact:  https://app.roll20.net/users/104025/the-aaron
    var TAS = TAS || (function(){
        'use strict';
    
        var version = '0.2.4',
            lastUpdate = 1457098091,
    
            loggingSettings = {
                debug: {
                    key:     'debug',
                    title:   'Starfinder-DEBUG',
                    color: {
                        bgLabel: '#7732A2',
                        label:   '#F2EF40',
                        bgText:  '#FFFEB7',
                        text:    '#7732A2'
                    }
                },
                error: {
                    key:     'error',
                    title:   'Starfinder-Error',
                    color: {
                        bgLabel: '#C11713',
                        label:   'white',
                        bgText:  '#C11713',
                        text:    'white'
                    }
                },
                warn: {
                    key:     'warn',
                    title:   'Starfinder-Warning',
                    color: {
                        bgLabel: '#F29140',
                        label:   'white',
                        bgText:  '#FFD8B7',
                        text:    'black'
                    }
                },
                info: {
                    key:     'info',
                    title:   'Starfinder-Info',
                    color: {
                        bgLabel: '#413FA9',
                        label:   'white',
                        bgText:  '#B3B2EB',
                        text:    'black'
                    }
                },
                notice: {
                    key:     'notice',
                    title:   'Starfinder-Notice',
                    color: {
                        bgLabel: '#33C133',
                        label:   'white',
                        bgText:  '#ADF1AD',
                        text:    'black'
                    }
                },
                log: {
                    key:     'log',
                    title:   'Starfinder-Log',
                    color: {
                        bgLabel: '#f2f240',
                        label:   'black',
                        bgText:  '#ffff90',
                        text:    'black'
                    }
                },
                callstack: {
                    key:     'TAS',
                    title:   'Starfinder-function',
                    color: {
                        bgLabel: '#413FA9',
                        label:   'white',
                        bgText:  '#B3B2EB',
                        text:    'black'
                    }
                },
                callstack_async: {
                    key:     'TAS',
                    title:   'Starfinder-ASYNC CALL',
                    color: {
                        bgLabel: '#413FA9',
                        label:   'white',
                        bgText:  '#413FA9',
                        text:    'white'
                    }
                },
                TAS: {
                    key:     'TAS',
                    title:   'Starfinder-TAS',
                    color: {
                        bgLabel: 'grey',
                        label:   'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)',
                        bgText:  'grey',
                        text:    'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)'
                    }
                }
            },
    
    
            config = {
                debugMode: false,
                logging: {
                    log: true,
                    notice: true,
                    info: true,
                    warn: true,
                    error: true,
                    debug: false
                }
            },
    
            callstackRegistry = [],
    		queuedUpdates = {}, //< Used for delaying saves till the last momment.
    
        complexType = function(o){
            switch(typeof o){
                case 'string':
                    return 'string';
                case 'boolean':
                    return 'boolean';
                case 'number':
                    return (_.isNaN(o) ? 'NaN' : (o.toString().match(/\./) ? 'decimal' : 'integer'));
                case 'function':
                    return 'function: '+(o.name ? o.name+'()' : '(anonymous)');
                case 'object':
                    return (_.isArray(o) ? 'array' : (_.isArguments(o) ? 'arguments' : ( _.isNull(o) ? 'null' : 'object')));
                default:
                    return typeof o;
            }
        },
    
    	dataLogger = function(primaryLogger,secondaryLogger,data){
            _.each(data,function(m){
                var type = complexType(m);
                switch(type){
                    case 'string':
                        primaryLogger(m);
                        break;
                    case 'undefined':
                    case 'null':
                    case 'NaN':
                        primaryLogger('['+type+']');
                        break;
                    case 'number':
                    case 'not a number':
                    case 'integer':
                    case 'decimal':
                    case 'boolean':
                        primaryLogger('['+type+']: '+m);
                        break;
                    default:
                        primaryLogger('['+type+']:=========================================');
                        secondaryLogger(m);
                        primaryLogger('=========================================================');
                        break;
                }
            });
    	},
    
    
        colorLog = function(options){
            var coloredLoggerFunction,
                key = options.key,
                label = options.title || 'TAS',
                lBGColor = (options.color && options.color.bgLabel) || 'blue',
                lTxtColor = (options.color && options.color.label) || 'white',
                mBGColor = (options.color && options.color.bgText) || 'blue',
                mTxtColor = (options.color && options.color.text) || 'white';
    
            coloredLoggerFunction = function(message){
                console.log(
                    '%c '+label+': %c '+message + ' ',
                    'background-color: '+lBGColor+';color: '+lTxtColor+'; font-weight:bold;',
                    'background-color: '+mBGColor+';color: '+mTxtColor+';'
                ); 
            };
            return function(){
                if('TAS'===key || config.logging[key]){
                   dataLogger(coloredLoggerFunction,function(m){console.log(m);},_.toArray(arguments)); 
                }
            };
        },
    
        logDebug  = colorLog(loggingSettings.debug),
        logError  = colorLog(loggingSettings.error),
        logWarn   = colorLog(loggingSettings.warn),
        logInfo   = colorLog(loggingSettings.info),
        logNotice = colorLog(loggingSettings.notice),
        logLog    = colorLog(loggingSettings.log),
        log       = colorLog(loggingSettings.TAS),
        logCS     = colorLog(loggingSettings.callstack),
        logCSA    = colorLog(loggingSettings.callstack_async),
    
        registerCallstack = function(callstack,label){
            var idx=_.findIndex(callstackRegistry,function(o){
                return (_.difference(o.stack,callstack).length === _.difference(callstack,o.stack).length) &&
                    _.difference(o.stack,callstack).length === 0 &&
                    o.label === label;
            });
            if(-1 === idx){
                idx=callstackRegistry.length;
                callstackRegistry.push({
                    stack: callstack,
                    label: label
                });
            }
            return idx;
        },
    
        setConfigOption = function(options){
            var newconf =_.defaults(options,config);
            newconf.logging=_.defaults(
                (options && options.logging)||{},
                config.logging
            );
            config=newconf;
        },
        
        debugMode = function(){
            config.logging.debug=true;
            config.debugMode = true;
        },
    
        getCallstack = function(){
            var e = new Error('dummy'),
                stack = _.map(_.rest(e.stack.replace(/^[^\(]+?[\n$]/gm, '')
                .replace(/^\s+at\s+/gm, '')
                .replace(/^Object.<anonymous>\s*\(/gm, '{anonymous}()@')
                .split('\n')),function(l){
                    return l.replace(/\s+.*$/,'');
                });
            return stack;
        },
        logCallstackSub = function(cs){
            var matches, csa;
            _.find(cs,function(line){
                matches = line.match(/TAS_CALLSTACK_(\d+)/);
                if(matches){
                   csa=callstackRegistry[matches[1]];
                   logCSA( '===================='+(csa.label ? '> '+csa.label+' <' : '')+'====================');
                   logCallstackSub(csa.stack);
                   return true;
                } 
                logCS(line);
                return false;
            });
        },
        logCallstack = function(){
            var cs;
            if(config.debugMode){
                cs = getCallstack();
                cs.shift();
                log('==============================> CALLSTACK <==============================');
                logCallstackSub(cs);
                log('=========================================================================');
            }
        },
    
    
        wrapCallback = function (label, callback, context){
            var callstack;
            if('function' === typeof label){
                context=callback;
                callback=label;
                label=undefined;
            }
            if(!config.debugMode){
                return (function(cb,ctx){
                    return function(){
                        cb.apply(ctx||{},arguments);
                    };
                }(callback,context));
            }
            
            callstack = getCallstack();
            callstack.shift();
            
            return (function(cb,ctx,cs,lbl){
                var ctxref=registerCallstack(cs,lbl);
    
                /*jshint -W054 */
                return new Function('cb','ctx','TASlog',
                    "return function TAS_CALLSTACK_"+ctxref+"(){"+
                        "TASlog('Entering: '+(cb.name||'(anonymous function)'));"+
                        "cb.apply(ctx||{},arguments);"+
                        "TASlog('Exiting: '+(cb.name||'(anonymous function)'));"+
                    "};")(cb,ctx,log);
                /*jshint +W054 */
            }(callback,context,callstack,label));
        },
    
    
        prepareUpdate = function( attribute, value ){
            queuedUpdates[attribute]=value;
        },
    
        applyQueuedUpdates = function() {
          setAttrs(queuedUpdates);
          queuedUpdates = {};
        },
    
    	namesFromArgs = function(args,base){
            return _.chain(args)
                .reduce(function(memo,attr){
                    if('string' === typeof attr) {
                        memo.push(attr);
                    } else if(_.isArray(args) || _.isArguments(args)){
                        memo = namesFromArgs(attr,memo);
                    }
                    return memo;
                },(_.isArray(base) && base) || [])
                .uniq()
                .value();
    	},
    
    	addId = function(obj,value){
    		Object.defineProperty(obj,'id',{
    			value: value,
    			writeable: false,
    			enumerable: false
    		});
    	},
    
    	addProp = function(obj,prop,value,fullname){
    		(function(){
                var pname=(_.contains(['S','F','I','D'],prop) ? '_'+prop : prop),
    			    full_pname = fullname || prop,
                    pvalue=value;
    
                _.each(['S','I','F'],function(p){
                    if( !_.has(obj,p)){
                        Object.defineProperty(obj, p, {
                            value: {},
                            enumerable: false,
                            readonly: true
                        });
                    }
                });
                if( !_.has(obj,'D')){
                    Object.defineProperty(obj, 'D', {
                        value: _.reduce(_.range(10),function(m,d){
                                Object.defineProperty(m, d, {
                                    value: {},
                                    enumerable: true,
                                    readonly: true
                                });
                                return m;
                            },{}),
                        enumerable: false,
                        readonly: true
                    });
                }
    
    
                // Raw value
    			Object.defineProperty(obj, pname, {
                    enumerable: true,
    				set: function(v){
                        if(v!==pvalue) {
                            pvalue=v;
                            prepareUpdate(full_pname,v);
                        }
    				},
    				get: function(){
    					return pvalue;
    				}
    			});
                
                // string value
    			Object.defineProperty(obj.S, pname, {
                    enumerable: true,
    				set: function(v){
                        var val=v.toString();
                        if(val !== pvalue) {
                            pvalue=val;
                            prepareUpdate(full_pname,val);
                        }
    				},
    				get: function(){
    					return pvalue.toString();
    				}
    			});
    
                // int value
    			Object.defineProperty(obj.I, pname, {
                    enumerable: true,
    				set: function(v){
                        var val=parseInt(v,10) || 0;
                        if(val !== pvalue){
                            pvalue=val;
                            prepareUpdate(full_pname,val);
                        }
    				},
    				get: function(){
    					return parseInt(pvalue,10) || 0;
    				}
    			});
    
                // float value
    			Object.defineProperty(obj.F, pname, {
                    enumerable: true,
    				set: function(v){
                        var val=parseFloat(v) || 0;
                        if(val !== pvalue) {
                            pvalue=val;
                            prepareUpdate(full_pname,val);
                        }
    				},
    				get: function(){
    					return parseFloat(pvalue) || 0;
    				}
    			});
                _.each(_.range(10),function(d){
                    Object.defineProperty(obj.D[d], pname, {
                        enumerable: true,
                        set: function(v){
                            var val=(parseFloat(v) || 0).toFixed(d);
                            if(val !== pvalue){
                                pvalue=val;
                                prepareUpdate(full_pname,val);
                            }
                        },
                        get: function(){
                            return (parseFloat(pvalue) || 0).toFixed(d);
                        }
                    });
                });
    
    		}());
    	},
    	
    	repeating = function( section ) {
    		return (function(s){
    			var sectionName = s,
    				attrNames = [],
    				fieldNames = [],
    				operations = [],
                    after = [],
    			
    			repAttrs = function TAS_Repeating_Attrs(){
    				attrNames = namesFromArgs(arguments,attrNames);
    				return this;
    			},
    			repFields = function TAS_Repeating_Fields(){
    				fieldNames = namesFromArgs(arguments,fieldNames);
    				return this;
    			},
    			repReduce = function TAS_Repeating_Reduce(func, initial, final, context) { 
    				operations.push({
                        type: 'reduce',
                        func: (func && _.isFunction(func) && func) || _.noop,
                        memo: (_.isUndefined(initial) && 0) || initial,
                        final: (final && _.isFunction(final) && final) || _.noop,
                        context: context || {}
                    });
    				return this;
    			},
    			repMap = function TAS_Repeating_Map(func, final, context) {
    				operations.push({
                        type: 'map',
                        func: (func && _.isFunction(func) && func) || _.noop,
                        final: (final && _.isFunction(final) && final) || _.noop,
                        context: context || {}
                    });
    				return this;
    			},
                repEach = function TAS_Repeating_Each(func, final, context) {
    				operations.push({
                        type: 'each',
                        func: (func && _.isFunction(func) && func) || _.noop,
                        final: (final && _.isFunction(final) && final) || _.noop,
                        context: context || {}
                    });
    				return this;
                },
                repTap = function TAS_Repeating_Tap(final, context) {
    				operations.push({
                        type: 'tap',
                        final: (final && _.isFunction(final) && final) || _.noop,
                        context: context || {}
                    });
    				return this;
                },
                repAfter = function TAS_Repeating_After(callback,context) {
    				after.push({
                        callback: (callback && _.isFunction(callback) && callback) || _.noop,
                        context: context || {}
                    });
    				return this;
                },
    			repExecute = function TAS_Repeating_Execute(callback,context){
    				var rowSet = {},
    					attrSet = {},
    					fieldIds = [],
    					fullFieldNames = [];
    
                    repAfter(callback,context);
    
    				// call each operation per row.
    				// call each operation's final
    				getSectionIDs("repeating_"+sectionName,function(ids){
    					fieldIds = ids;
    					fullFieldNames = _.reduce(fieldIds,function(memo,id){
    						return memo.concat(_.map(fieldNames,function(name){
    							return 'repeating_'+sectionName+'_'+id+'_'+name;  
    						}));
    					},[]);
    					getAttrs( _.uniq(attrNames.concat(fullFieldNames)), function(values){
    						_.each(attrNames,function(aname){
    							if(values.hasOwnProperty(aname)){
    								addProp(attrSet,aname,values[aname]);
    							}
    						});
    
    						rowSet = _.reduce(fieldIds,function(memo,id){
    							var r={};
    							addId(r,id);
    							_.each(fieldNames,function(name){
    								var fn = 'repeating_'+sectionName+'_'+id+'_'+name;  
    								addProp(r,name,values[fn],fn);
    							});
    
    							memo[id]=r;
    
    							return memo;
    						},{});
    
                            _.each(operations,function(op){
                                var res;
                                switch(op.type){
                                    case 'tap':
                                        _.bind(op.final,op.context,rowSet,attrSet)();
                                        break;
    
                                    case 'each':
                                        _.each(rowSet,function(r){
                                            _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                        });
                                        _.bind(op.final,op.context,rowSet,attrSet)();
                                        break;
    
                                    case 'map':
                                        res = _.map(rowSet,function(r){
                                            return _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                        });
                                        _.bind(op.final,op.context,res,rowSet,attrSet)();
                                        break;
    
                                    case 'reduce':
                                        res = op.memo;
                                        _.each(rowSet,function(r){
                                            res = _.bind(op.func,op.context,res,r,attrSet,r.id,rowSet)();
                                        });
                                        _.bind(op.final,op.context,res,rowSet,attrSet)();
                                        break;
                                }
                            });
    
                            // finalize attrs
                            applyQueuedUpdates();
                            _.each(after,function(op){
                                _.bind(op.callback,op.context)();
                            });
    					});
    				});
    			};
    				
    			return {
    				attrs: repAttrs,
    				attr: repAttrs,
    
    				column: repFields,
    				columns: repFields,
    				field: repFields,
    				fields: repFields,
    
    				reduce: repReduce,
    				inject: repReduce,
    				foldl: repReduce,
    
    				map: repMap,
    				collect: repMap,
    
    				each: repEach,
                    forEach: repEach,
    
                    tap: repTap,
                    'do': repTap,
    
    				after: repAfter,
    				last: repAfter,
    				done: repAfter,
    
    				execute: repExecute,
    				go: repExecute,
    				run: repExecute
    			};
    		}(section));
    	},
    
    
        repeatingSimpleSum = function(section, field, destination){
            repeating(section)
                .attr(destination)
                .field(field)
                .reduce(function(m,r){
                    return m + (r.F[field]);
                },0,function(t,r,a){
                    a.S[destination]=t;
                })
                .execute();
        };
    
    	console.log('%c..*`*..*`*.  The Aaron Sheet  v'+version+'  .*`*..*`*..','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
    	console.log('%c..*`*..*`*.  Last update: '+(new Date(lastUpdate*1000))+'  .*`*..*`*..','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
    
    
        return {
            /* Repeating Sections */
            repeatingSimpleSum: repeatingSimpleSum,
    		repeating: repeating,
    
            /* Configuration */
            config: setConfigOption,
    
            /* Debugging */
            callback: wrapCallback,
            callstack: logCallstack,
            debugMode: debugMode,
            _fn: wrapCallback,
    
            /* Logging */
            debug: logDebug,
            error: logError,
            warn: logWarn,
            info: logInfo,
            notice: logNotice,
            log: logLog
        };
    }());
    
    /* ---- END: TheAaronSheet.js ---- */
    /*start starfinder.js*/
    var starfinder = starfinder || (function(){
        'use strict';
        var version = 0.01,
            attributeAffected={
                'eac':{
                    repeating:false,
                    total:'eac',
                    numAdds:10,
                    attrAdds:['eac_armor'],
                    ability:'eac_ability'
                },
                'kac':{
                    repeating:false,
                    total:'kac',
                    numAdds:10,
                    attrAdds:['kac_armor'],
                    ability:'kac_ability'
                },
                'fort':{
                    repeating:false,
                    total:'fort',
                    attrAdds:['fort_base'],
                    ability:'fort_ability'
                },
                'ref':{
                    repeating:false,
                    total:'ref',
                    attrAdds:['ref_base'],
                    ability:'ref_ability'
                },
                'will':{
                    repeating:false,
                    total:'will',
                    attrAdds:['will_base'],
                    ability:'will_ability'
                },
                'initiative':{
                    repeating:false,
                    total:'initiative',
                    attrAdds:[],
                    ability:'initiative_ability'
                },
                'acrobatics':{
                    repeating:false,
                    total:'acrobatics',
                    attrAdds:['acrobatics_ranks','acrobatics_class_skill'],
                    ability:'acrobatics_ability'
                },
                'athletics':{
                    repeating:false,
                    total:'athletics',
                    attrAdds:['athletics_ranks','athletics_class_skill'],
                    ability:'athletics_ability'
                },
                'bluff':{
                    repeating:false,
                    total:'bluff',
                    attrAdds:['bluff_ranks','bluff_class_skill'],
                    ability:'bluff_ability'
                },
                'computers':{
                    repeating:false,
                    total:'computers',
                    attrAdds:['computers_ranks','computers_class_skill'],
                    ability:'computers_ability'
                },
                'culture':{
                    repeating:false,
                    total:'culture',
                    attrAdds:['culture_ranks','culture_class_skill'],
                    ability:'culture_ability'
                },
                'diplomacy':{
                    repeating:false,
                    total:'diplomacy',
                    attrAdds:['diiplomacy_ranks','diiplomacy_class_skill'],
                    ability:'diiplomacy_ability'
                },
                'engineering':{
                    repeating:false,
                    total:'engineering',
                    attrAdds:['engineering_ranks','engineering_class_skill'],
                    ability:'engineering_ability'
                },
                'intimidate':{
                    repeating:false,
                    total:'intimidate',
                    attrAdds:['intimidate_ranks','intimidate_class_skill'],
                    ability:'intimidate_ability'
                },
                'life_science':{
                    repeating:false,
                    total:'life_science',
                    attrAdds:['life_science_ranks','life_science_class_skill'],
                    ability:'life_science_ability'
                },
                'medicine':{
                    repeating:false,
                    total:'medicine',
                    attrAdds:['medicine_ranks','medicine_class_skill'],
                    ability:'medicine_ability'
                },
                'mysticism':{
                    repeating:false,
                    total:'mysticism',
                    attrAdds:['mysticism_ranks','mysticism_class_skill'],
                    ability:'_ability'
                },
                'perception':{
                    repeating:false,
                    total:'perception',
                    attrAdds:['perception_ranks','perception_class_skill'],
                    ability:'perception_ability'
                },
                'physical_science':{
                    repeating:false,
                    total:'physical_science',
                    attrAdds:['physical_science_ranks','physical_science_class_skill'],
                    ability:'physical_science_ability'
                },
                'piloting':{
                    repeating:false,
                    total:'piloting',
                    attrAdds:['piloting_ranks','piloting_class_skill'],
                    ability:'piloting_ability'
                },
                'profession':{
                    repeating:'profession',
                    total:'profession',
                    attrAdds:['profession_ranks','profession_class_skill'],
                    ability:'profession_ability'
                },
                'sense_motive':{
                    repeating:false,
                    total:'sense_motive',
                    attrAdds:['sense_motive_ranks','sense_motive_class_skill'],
                    ability:'sense_motive_ability'
                },
                'sleight_of_hand':{
                    repeating:false,
                    total:'sleight_of_hand',
                    attrAdds:['sleight_of_hand_ranks','sleight_of_hand_class_skill'],
                    ability:'sleight_of_hand_ability'
                },
                'stealth':{
                    repeating:false,
                    total:'stealth',
                    attrAdds:['stealth_ranks','stealth_class_skill'],
                    ability:'stealth_ability'
                },
                'survival':{
                    repeating:false,
                    total:'survival',
                    attrAdds:['survival_ranks','survival_class_skill'],
                    ability:'survival_ability'
                },
                'attack_total':{
                    repeating:'attack',
                    total:'attack_total',
                    attrAdds:['bab'],
                    repeatAdds:['attack_total_ranks','attack_total_class_skill'],
                    ability:'attack_ability'
                },
                'attack_dmg':{
                    repeating:'attack',
                    total:'attack_dmg',
                    repeatAdds:['attack_dmg_ranks','attack_dmg_class_skill'],
                    ability:'attack_dmg_ability'
                }
            },
            repeatingAttrAffected = {
                'attack':{
                    'attack_total':'attack_ability',
                    'attack_dmg_total':'attack_dmg_ability'
                },
                'profession':{
                    'profession':'profession_ability'
                }
            },
            sheetAttributes = [
                //Class & Character attributes
                'class-1-name','class-2-name','class-3-name','class-4-name','class-5-name',
                'class-1-level','class-2-level','class-3-level','class-4-level','class-5-level','class-1-sp','class-2-sp',
                'class-3-sp','class-4-sp','class-5-sp','class-1-hp','class-2-hp','class-3-hp','class-4-hp','class-5-hp',
                'class-1-bab','class-2-bab','class-3-bab','class-4-bab','class-5-bab',
                'class-1-fort','class-2-fort','class-3-fort','class-4-fort','class-5-fort',
                'class-1-ref','class-2-ref','class-3-ref','class-4-ref','class-5-ref',
                'class-1-will','class-2-will','class-3-will','class-4-will','class-5-will',
                'class-1-ability','class-2-ability','class-3-ability','class-4-ability','class-5-ability',
                'race_hp',
                //ability score attributes
                'strength','dexterity','constitution','intelligence','wisdom','charisma','strength_penalty','dexterity_penalty','constitution_penalty',
                'strength_base','dexterity_base','constitution_base','intelligence_base','wisdom_base','charisma_base',
                'intelligence_penalty','wisdom_penalty','charisma_penalty','strength_drain','dexterity_drain','constitution_drain','intelligence_drain',
                'wisdom_drain','charisma_drain','strength_mod','dexterity_mod','constitution_mod','intelligence_mod','wisdom_mod','charisma_mod',
                //Initiative attributes
                'initiative_ability',
                //AC attributes
                'eac','kac','cmd','eac_armor','kac_armor','eac_ability','kac_ability',
                //Save attributess
                'fort','ref','will','fort_base','ref_base','will_base','fort_ability','ref_ability','will_ability',
                //Skill attributes
                'acrobatics','athletics','bluff','computers','culture','diplomacy','disguise','engineering','intimidate','life_science','medicine','mysticism',
                'perception','physical_science','piloting','sense_motive','sleight_of_hand','stealth','survival','acrobatics_ability','athletics_ability',
                'bluff_ability','computers_ability','culture_ability','diplomacy_ability','disguise_ability','engineering_ability','intimidate_ability',
                'life_science_ability','medicine_ability','mysticism_ability','perception_ability','physical_science_ability','piloting_ability',
                'sense_motive_ability','sleight_of_hand_ability','stealth_ability','survival_ability','acrobatics_ranks','athletics_ranks','bluff_ranks',
                'computers_ranks','culture_ranks','diplomacy_ranks','disguise_ranks','engineering_ranks','intimidate_ranks','life_science_ranks',
                'medicine_ranks','mysticism_ranks','perception_ranks','physical_science_ranks','piloting_ranks','sense_motive_ranks','sleight_of_hand_ranks',
                'stealth_ranks','survival_ranks','acrobatics_class_skill','athletics_class_skill','bluff_class_skill','computers_class_skill',
                'culture_class_skill','diplomacy_class_skill','disguise_class_skill','engineering_class_skill','intimidate_class_skill',
                'life_science_class_skill','medicine_class_skill','mysticism_class_skill','perception_class_skill','physical_science_class_skill',
                'piloting_class_skill','sense_motive_class_skill','sleight_of_hand_class_skill','stealth_class_skill','survival_class_skill',
                //Health attributes
                'sp','hp','rp','temp_hp','sp_max','hp_max','rp_max','temp_hp_max',
                //Item attributes
                'wealth','carried_bulk','encumber_bulk','overburden_bulk',
                //general sheet attributes
                'bab','level'
            ],
            repeatingAttributes = [
                {
                    section:'item',
                    fields:['item_name','item_bulk','item_cost','item_quantity','item_mods','item_equipped']
                },
                {
                    section:'attack',
                    fields:['attack_ability','attack_bonus','attack_dmg_dice','attack_dmg_ability','attack_damage']
                },
            ],
            noRepeat = ['sp','hp','rp','temp_hp','credits','class-1-name','class-2-name','class-3-name','class-4-name','class-5-name','character_name','race','language','player','deity','alignment','home_world','gender','theme','item_name','attack_name','profession_name','attack_range','attack_usage','attack_crit','attack_special','attack_description','attack_macro','item_description',],
            
            
        RegisterEventHandlers = function(){
            on('change:class-1-name change:class-2-name change:class-3-name change:class-4-name change:class-5-name change:class-1-level '
            +'change:class-2-level change:class-3-level change:class-4-level change:class-5-level change:class-1-sp change:class-2-sp '
            +'change:class-3-sp change:class-4-sp change:class-5-sp change:class-1-hp change:class-2-hp change:class-3-hp change:class-4-hp '
            +'change:class-5-hp change:class-1-bab change:class-2-bab change:class-3-bab change:class-4-bab change:class-5-bab change:class-1-fort '
            +'change:class-2-fort change:class-3-fort change:class-4-fort change:class-5-fort change:class-1-ref change:class-2-ref '
            +'change:class-3-ref change:class-4-ref change:class-5-ref change:class-1-will change:class-2-will change:class-3-will '
            +'change:class-4-will change:class-5-will change:class-1-skills change:class-2-skills change:class-3-skills change:class-4-skills '
            +'change:class-5-skills change:class-1-ability change:class-2-ability change:class-3-ability change:class-4-ability '
            +'change:class-5-ability change:race_hp change:strength_base change:strength_enhance change:strength_penalty change:strength_drain '
            +'change:dexterity_base change:dexterity_enhance change:dexterity_penalty change:dexterity_drain change:constitution_base '
            +'change:constitution_enhance change:constitution_penalty change:constitution change:intelligence_base change:intelligence_enhance '
            +'change:intelligence_penalty change:intelligence_drain change:wisdom_base change:wisdom_enhance change:wisdom_penalty change:wisdom_drain '
            +'change:charisma_base change:charisma_enhance change:charisma_penalty change:charisma_drain change:eac_ability change:kac_ability '
            +'change:fort_ability change:ref_ability change:will_ability change:initiative_ability change:sp change:hp change:rp '
            +'change:acrobatics_ranks change:acrobatics_class_skill change:acrobatics_ability change:athletics_ranks change:athletics_class_skill '
            +'change:athletics_ability change:bluff_ranks change:bluff_class_skill change:bluff_ability change:computers_ranks '
            +'change:computers_class_skill change:computers_ability change:culture_ranks change:culture_class_skill change:culture_ability '
            +'change:diplomacy_ranks change:diplomacy_class_skill change:diplomacy_ability change:disguise_ranks change:disguise_class_skill '
            +'change:disguise_ability change:engineering_ranks change:engineering_class_skill change:engineering_ability  change:intimidate_ranks '
            +'change:intimidate_class_skill change:intimidate_ability  change:life_science_ranks change:life_science_class_skill '
            +'change:life_science_ability  change:medicine_ranks change:medicine_class_skill change:medicine_ability  change:mysticism_ranks '
            +'change:mysticism_class_skill change:mysticism_ability  change:perception_ranks change:perception_class_skill '
            +'change:perception_ability  change:physical_science_ranks change:physical_science_class_skill change:physical_science_ability '
            +'change:piloting_ranks change:piloting_class_skill change:piloting_ability change:repeating_profession:profession_ranks '
            +'change:repeating_profession:profession_class_skill change:repeating_profession:profession_ability change:sense_motive_ranks '
            +'change:sense_motive_class_skill change:sense_motive_ability change:sleight_of_hand_ranks change:sleight_of_hand_class_skill '
            +'change:sleight_of_hand_ability change:stealth_ranks change:stealth_class_skill change:stealth_ability change:survival_ranks '
            +'change:survival_class_skill change:survival_ability '
            +'change:repeating_item:item_bulk change:repeating_item:item_cost change:repeating_item:item_cost change:repeating_item:item_mods change:repeating_item:equipped '
            +'change:repeating_attack:attack_ability change:repeating_attack:attack_dmg_ability '
            +'change:repeating_profession:profession_ranks change:repeating_profession:profession_class_skill change:repeating_profession:profession_ability',
            accessStarfinder);
        },
        SUM = function(numArr){
            return _.reduce(numArr,(memo, n)=>{return memo + (n*1||n)},0);
        },
        
        BUFFMAX = function (modArr){
            return _.reduce(modArr,(memo,n)=>{return Math.max(memo,n)||memo+n});
        },
        
        accessStarfinder = function (event){
            var attribute = event.sourceAttribute.replace(/repeating_[^_]+_-[^_]+_/,''),
                repeatSec = event.sourceAttribute.match(/repeating_([^_]+)/) ? event.sourceAttribute.match(/repeating_([^_]+)/)[1] : false,
                cloneRepAttr = JSON.parse(JSON.stringify(repeatingAttributes)),
                sectionAggregate = [],
                currSection,
                attributes=[],
                setObj,bonuses,
                eventSwitch = {
                    'class-1-name':classNameHandler,'class-2-name':classNameHandler,'class-3-name':classNameHandler,'class-4-name':classNameHandler,'class-5-name':classNameHandler,
                    'class-1-level':classLevelHandler,'class-2-level':classLevelHandler,'class-3-level':classLevelHandler,'class-4-level':classLevelHandler,'class-5-level':classLevelHandler,
                    'class-1-sp':classHealthHandler,'class-2-sp':classHealthHandler,'class-3-sp':classHealthHandler,'class-4-sp':classHealthHandler,'class-5-sp':classHealthHandler,
                    'class-1-hp':classHealthHandler,'class-2-hp':classHealthHandler,'class-3-hp':classHealthHandler,'class-4-hp':classHealthHandler,'class-5-hp':classHealthHandler,
                    'class-1-bab':classBabHandler,'class-2-bab':classBabHandler,'class-3-bab':classBabHandler,'class-4-bab':classBabHandler,'class-5-bab':classBabHandler,
                    'class-1-fort':classSaveHandler,'class-2-fort':classSaveHandler,'class-3-fort':classSaveHandler,'class-4-fort':classSaveHandler,
                    'class-5-fort':classSaveHandler,'class-1-ref':classSaveHandler,'class-2-ref':classSaveHandler,'class-3-ref':classSaveHandler,'class-4-ref':classSaveHandler,
                    'class-5-ref':classSaveHandler,'class-1-will':classSaveHandler,'class-2-will':classSaveHandler,'class-3-will':classSaveHandler,'class-4-will':classSaveHandler,
                    'class-5-will':classSaveHandler,
                    'class-1-skills':classSkillHandler,'class-2-skills':classSkillHandler,'class-3-skills':classSkillHandler,'class-4-skills':classSkillHandler,
                    'class-5-skills':classSkillHandler,
                    'class-1-ability':classAbilityHandler,'class-2-ability':classAbilityHandler,'class-3-ability':classAbilityHandler,'class-4-ability':classAbilityHandler,
                    'class-5-ability':classAbilityHandler,
                    'race_hp':classHealthHandler,
                    'strength_base':attributeHandler,'strength_enhance':attributeHandler,'strength_penalty':attributeHandler,'strength_drain':attributeHandler,
                    'dexterity_base':attributeHandler,'dexterity_enhance':attributeHandler,'dexterity_penalty':attributeHandler,'dexterity_drain':attributeHandler,
                    'constitution_base':attributeHandler,'constitution_enhance':attributeHandler,'constitution_penalty':attributeHandler,'constitution_drain':attributeHandler,
                    'intelligence_base':attributeHandler,'intelligence_enhance':attributeHandler,'intelligence_penalty':attributeHandler,'intelligence_drain':attributeHandler,
                    'wisdom_base':attributeHandler,'wisdom_enhance':attributeHandler,'wisdom_penalty':attributeHandler,'wisdom_drain':attributeHandler,
                    'charisma_base':attributeHandler,'charisma_enhance':attributeHandler,'charisma_penalty':attributeHandler,'charisma_drain':attributeHandler,
                    'eac_ability':acHandler,'kac_ability':acHandler,
                    'fort_ability':saveHandler,'ref_ability':saveHandler,'will_ability':saveHandler,
                    'initiative_ability':initiativeHandler,
                    'sp':healthHandler,'hp':healthHandler,'rp':healthHandler,
                    'acrobatics_ranks':skillHandler,
                    'acrobatics_class_skill':skillHandler,
                    'acrobatics_ability':skillHandler,
                    'athletics_ranks':skillHandler,
                    'athletics_class_skill':skillHandler,
                    'athletics_ability':skillHandler,
                    'bluff_ranks':skillHandler,
                    'bluff_class_skill':skillHandler,
                    'bluff_ability':skillHandler,
                    'computers_ranks':skillHandler,
                    'computers_class_skill':skillHandler,
                    'computers_ability':skillHandler,
                    'culture_ranks':skillHandler,
                    'culture_class_skill':skillHandler,
                    'culture_ability':skillHandler,
                    'diplomacy_ranks':skillHandler,
                    'diplomacy_class_skill':skillHandler,
                    'diplomacy_ability':skillHandler,
                    'disguise_ranks':skillHandler,
                    'disguise_class_skill':skillHandler,
                    'disguise_ability':skillHandler,
                    'engineering_ranks':skillHandler,
                    'engineering_class_skill':skillHandler,
                    'engineering_ability':skillHandler,
                    'intimidate_ranks':skillHandler,
                    'intimidate_class_skill':skillHandler,
                    'intimidate_ability':skillHandler,
                    'life_science_ranks':skillHandler,
                    'life_science_class_skill':skillHandler,
                    'life_science_ability':skillHandler,
                    'medicine_ranks':skillHandler,
                    'medicine_class_skill':skillHandler,
                    'medicine_ability':skillHandler,
                    'mysticism_ranks':skillHandler,
                    'mysticism_class_skill':skillHandler,
                    'mysticism_ability':skillHandler,
                    'perception_ranks':skillHandler,
                    'perception_class_skill':skillHandler,
                    'perception_ability':skillHandler,
                    'physical_science_ranks':skillHandler,
                    'physical_science_class_skill':skillHandler,
                    'physical_science_ability':skillHandler,
                    'piloting_ranks':skillHandler,
                    'piloting_class_skill':skillHandler,
                    'piloting_ability':skillHandler,
                    'profession_ranks':skillHandler,
                    'profession_class_skill':skillHandler,
                    'profession_ability':skillHandler,
                    'sense_motive_ranks':skillHandler,
                    'sense_motive_class_skill':skillHandler,
                    'sense_motive_ability':skillHandler,
                    'sleight_of_hand_ranks':skillHandler,
                    'sleight_of_hand_class_skill':skillHandler,
                    'sleight_of_hand_ability':skillHandler,
                    'stealth_ranks':skillHandler,
                    'stealth_class_skill':skillHandler,
                    'stealth_ability':skillHandler,
                    'survival_ranks':skillHandler,
                    'survival_class_skill':skillHandler,
                    'survival_ability':skillHandler,
                    'profession_ranks':skillHandler,'profession_class_skill':skillHandler,'profession_ability':skillHandler,
                    'item_bulk':equipmentHandler,'item_cost':equipmentHandler,'item_mods':equipmentHandler,'equipped':equipmentHandler,
                    'attack_ability':attackHandler,'attack_dmg_ability':attackHandler,
                },
                getID = () => {
                    currSection=cloneRepAttr.shift();
                    getSectionIDs('repeating_'+currSection.section,(itemIDArr)=>{
                        sectionAggregate.push({
                            section:currSection.section,
                            id:itemIDArr,
                            fields:currSection.fields
                        });
                        if(_.isEmpty(cloneRepAttr)){
                            useID();
                        }else{
                            getID();
                        }
                    });
                },
                useID = () => {
                    _.each(sectionAggregate,(section)=>{
                        _.each(section.id,(sid)=>{
                            _.each(section.fields,(f)=>{
                                attributes.push('repeating_'+section.section+'_'+sid+'_'+f);
                            });
                        });
                    });
                    attributes = attributes.concat(sheetAttributes);
                    getAttrs(attributes,(objs)=>{
                        bonuses=parseBuffs(objs);
                        setObj=eventSwitch[attribute](objs,bonuses,attribute);
                        setAttrs(setObj,{silent:true});
                    });
                };
            getID();
        },
        //class attribute handling functions
        classNameHandler = function(attributes){
            var temp,
                classNL = _.reduce([1,2,3,4,5],(memo,n)=>{
                    temp=(attributes['class-'+n+'-name']||'')+((attributes['class-'+n+'-name']&&attributes['class-'+n+'-name']!==''&&attributes['class-'+n+'-level']&&attributes['class-'+n+'-level']!=='') ? ' ' : '')+(attributes['class-'+n+'-level']||'');
                    memo+=temp.length>0 ? (memo.length>0 ? ' / ' : '')+temp : '';
                    return memo;
                },'');
                return {'class&level':classNL};
        },
        
        parseBuffs = function(attributes){
            var modRegex = /((?:\+|\-).*?(?=(?:\s+[^\s]+)?\s+to))(?:\s+([^\s]+))?\s+to\s+(carried_bulk|encumber_bulk|overburden_bulk|strength|dexterity|constitution|intelligence|wisdom|charisma|wealth|strength_penalty|dexterity_penalty|eac|kac|eac_armor|kac_armor|fort|ref|will|acrobatics|athletics|bluff|computers|culture|diplomacy|disguise|engineering|intimidate|life_science|medicine|mysticism|perception|physical_science|piloting|sense_motive|sleight_of_hand|stealth|survival|sp|hp|rp)/i,
                buffSplit,buffMatch,buff,buffType,buffed,evalBuff,
                buffFields = _.chain(_.keys(attributes))
                    .filter((k)=>{
                        return k.match(/repeating_(?:item_-[^_]+_item_mods|buff_-[^_]+_buff_mods)/);
                    })
                    .filter((k)=>{
                        return attributes[k.replace(/item_mods/,'item_equipped').replace(/buff_mods/,'buff_enabled')] ? attributes[k.replace(/item_mods/,'item_equipped').replace(/buff_mods/,'buff_enabled')].match(/enabled|equipped/) : false;
                    })
                    .map((k)=>{
                        return attributes[k];
                    })
                    .reject((f)=>{return _.isEmpty(f)})
                    .reduce((memo,f)=>{
                        buffSplit = f.split(',');
                        memo=memo.concat(buffSplit);
                        return memo;
                    },[])
                    .reduce((memo,f)=>{
                        buffMatch = f.match(modRegex);
                        if(buffMatch){
                            buff = buffMatch[1].replace(/(floor|ceil|abs|round|abs)\(/,'Math.$1(').replace(/@{([^}]+)}/,(match,p1)=>{
                                return attributes[p1.toLowerCase()]||'@{'+p1+'}';
                            });
                            try{
                                evalBuff = eval(buff);
                            }catch(err){
                                evalBuff = buff;
                            }
                            buffed = buffMatch[buffMatch.length - 1].toLowerCase();
                            buffType = buffMatch.length===4 ? buffMatch[2].toLowerCase() : 'untyped';
                            memo[buffed]=memo[buffed]||{};
                            memo[buffed][buffType]=memo[buffed][buffType]||[];
                            memo[buffed][buffType].push(evalBuff);
                        }
                        return memo;
                    },{})
                    .each((attr)=>{
                        _.each(_.keys(attr),(k)=>{
                            if(k==='untyped' || k==='circumstance'){
                                attr[k]=SUM(attr[k]);
                            }else {
                                attr[k]=BUFFMAX(attr[k]);
                            }
                        });
                    })
                    .value();
            _.each(_.keys(buffFields),(b)=>{
                buffFields[b] = SUM(_.map(buffFields[b],(f)=>{return f}));
            });
            return buffFields;
        },
        
        classLevelHandler = function(attributes,bonus){
            var convertSave = {
                    'poor':(lvl)=>Math.floor(lvl/3),
                    'good':(lvl)=>lvl>0 ? (Math.floor(lvl/2) + 2) : 0
                },
                temp,
                rpAbilities = [];
            return _.reduce([1,2,3,4,5],(memo,n)=>{
                    temp=(attributes['class-'+n+'-name']||'')+((attributes['class-'+n+'-name']&&attributes['class-'+n+'-name']!==''&&attributes['class-'+n+'-level']&&attributes['class-'+n+'-level']!=='') ? ' ' : '')+(attributes['class-'+n+'-level']||'');
                    //class name/level handling
                    memo['class&level']+=temp.length>0 ? (memo['class&level'].length>0 ? ' / ' : '')+temp : '';
                    //level handling
                    memo.level+=(attributes['class-'+n+'-level']*1||0);
                    //save handling
                    _.each(['fort','ref','will'],(s)=>{
                        memo[s+'_base']+=convertSave[attributes['class-'+n+'-'+s]](attributes['class-'+n+'-level']*1||0);
                    });
                    
                    //bab handling
                    memo.bab+=Math.floor(attributes['class-'+n+'-bab']*attributes['class-'+n+'-level']);
                    //health handling
                    memo.hp_max+=attributes['class-'+n+'-hp']*attributes['class-'+n+'-level'];
                    memo.sp_max+=attributes['class-'+n+'-sp']*attributes['class-'+n+'-level'];
                    if(attributes['class-'+n+'-level']*1>0){
                        rpAbilities.push(attributes[attributes['class-'+n+'-ability']]*1);
                    }
                    //Apply bonuses and total aggregate attributes
                    if(n===5){
                        _.each(['fort','ref','will'],(s)=>{
                            memo[s+'_base']+=(bonus[s+'_base']||0);
                            memo[s]+=(memo[s+'_base']*1||0)+(bonus[s]||0)+attributes[attributes[s+'_ability']]*1;
                        });
                        memo['hp_max']+=attributes['race_hp']*1;
                        memo['rp_max']=Math.max(Math.max(Math.floor(memo.level/2),1)+_.max(rpAbilities),1);
                        _.each(['hp','sp','rp'],(h)=>{
                            let diff = memo[h+'_max']-attributes[h+'_max']*1;
                            memo[h] = Math.max(memo[h]+diff,0);
                        });
                        
                    }
                    return memo;
                },{'class&level':'',level:0,hp_max:0,hp:attributes.hp*1,sp_max:0,sp:attributes.sp*1,rp_max:0,rp:attributes.rp*1,fort_base:0,ref_base:0,will_base:0,fort:0,ref:0,will:0,bab:0});
        },
        
        classHealthHandler = function(attributes,bonus,changed){
            var healthType = changed.replace(/class\-\d\-|race_/,''),
                cmemo={};
                
            cmemo[healthType]=attributes[healthType]*1;
            cmemo[healthType+'_max']=0;
            return _.reduce([1,2,3,4,5],(memo,n)=>{
                memo[healthType+'_max']+=attributes['class-'+n+'-'+healthType]*attributes['class-'+n+'-level'];
                if(n===5){
                    memo[healthType+'_max']+=(bonus[healthType+'_max']||0)+(bonus[healthType]||0)+(healthType==='hp' ? attributes['race_hp']*1 : 0);
                    let diff = memo[healthType+'_max']-attributes[healthType+'_max']*1;
                    memo[healthType]= Math.max(memo[healthType]+diff,0);
                }
                return memo;
            },cmemo);
        },
        
        classBabHandler = function(attributes,bonus){
            return _.reduce([1,2,3,4,5],(memo,n)=>{
                memo.bab+=Math.floor(attributes['class-'+n+'-bab']*attributes['class-'+n+'-level']);
                if(n==5){
                    memo.bab+=bonus.bab||0;
                }
                return memo;
            },{bab:0});
        },
        
        classSaveHandler = function(attributes,bonus,changed){
            var saveType = changed.replace(/class\-\d\-/,''),
                cmemo={},
                convertSave = {
                    'poor':(lvl)=>Math.floor(lvl/3),
                    'good':(lvl)=>lvl>0 ? (Math.floor(lvl/2) + 2) : 0
                };
                
            cmemo[saveType]=0;
            cmemo[saveType+'_base']=0;
            return _.reduce([1,2,3,4,5],(memo,n)=>{
                memo[saveType+'_base']+=convertSave[attributes['class-'+n+'-'+saveType]](attributes['class-'+n+'-level']);
                if(n===5){
                    memo[saveType+'_base']+=(bonus[saveType+'_base']||0);
                    memo[saveType]=memo[saveType+'_base']+attributes[attributes[saveType+'_ability']]*1+(bonus[saveType]||0);
                }
                return memo;
            },cmemo);
        },
        
        classSkillHandler = function(attributes,bonus){
            
        },
        
        classAbilityHandler = function(attributes,bonus){
            var rpAbilities=[];
            return _.reduce([1,2,3,4,5],(memo,n)=>{
                if(attributes['class-'+n+'-level']>0){
                    rpAbilities.push(attributes[attributes['class-'+n+'-ability']]*1);
                }
                if(n===5){
                    memo.rp_max=Math.max(Math.max(Math.floor(attributes.level/2),1)+_.max(rpAbilities),1);
                    let diff = memo.rp_max-attributes.rp_max*1;
                    memo.rp = Math.max(memo.rp+diff,0);
                }
                return memo;
            },{rp:attributes.rp*1,rp_max:0})
        },
        //End Class attribute handling functions
        
        //Sheet Section Handling Functions
        attributeHandler = function(attributes,bonus,changed){
            var attribute = changed.replace(/_(?:drain|penalty|base)/,''),
                setObj = {},
                attrKeys = _.keys(attributes),
                sectionAttributes,IDs;
                
            setObj[attribute]=(attributes[attribute+'_base']*1||10)-(attributes[attribute+'_drain']*1||0)+(bonus[attribute]||0);
            setObj[attribute+'_mod']=Math.floor((setObj[attribute] - 10)/2)-Math.floor((attributes[attribute+'_penalty']||0)/2);
            if(attribute==='strength'){
                setObj.encumber_bulk=Math.floor(setObj[attribute]/2);
                setObj.overburden_bulk=setObj[attribute];
            }else if(attribute==='constitution'){
                setObj.sp_max = _.reduce([1,2,3,4,5],(memo,n)=>{
                    return memo + (attributes['class-'+n+'-sp']*attributes['class-'+n+'-level']||0)+(n===5 ? attributes['consitution_mod']*1 : 0);
                },0)
                setObj.sp = Math.max(attributes.sp*1+(setObj.sp_max - attributes.sp_max*1),0);
            }
            setObj[attribute+'_change']=(setObj[attribute]===attributes[attribute+'_base']*1 ? 0 : (setObj[attribute] < attributes[attribute+'_base']*1 ? -1 : 1));
            if(setObj[attribute+'_mod']!==attributes[attribute+'_mod']*1){
                setObj=_.reduce(attributeAffected,(memo,a)=>{
                    TAS.log(JSON.stringify(a));
                    if(a.repeating){
                        sectionAttributes = _.filter(_.keys(attributes),(attr)=>{
                            return attr.match(new RegExp('repeating_'+a.repeating));
                        });
                        IDs = _.chain(sectionAttributes)
                            .map((attr)=>{
                                return attr.match(/-[^_]+/)[0];
                            })
                            .unique()
                            .value();
                        _.each(IDs,(i)=>{
                            if(attributes['repeating_'+a.repeating+'_'+i+'_'+a.ability]===attribute+'_mod'){
                                memo['repeating_'+a.repeating+'_'+i+'_'+a.total]=memo[attribute+'_mod']+(_.reduce(a.repeatAdds,(memo,adds)=>{return memo + (attributes['repeating_'+a.repeating+'_'+i+'_'+adds]*1||0)},0)||0)+(_.reduce(a.attrAdds,(memo,adds)=>{return memo + (attributes[adds]*1||0)},0)||0)+(a.numAdds||0)+(bonus[a.total]||0);
                            }
                        });
                    }else if(attributes[a.ability]===attribute+'_mod'){
                        memo[a.total]=memo[attribute+'_mod']+_.reduce(a.attrAdds,(memo,adds)=>{return memo + (attributes[adds]*1||0)},0)+(a.numAdds||0)+(bonus[a.total]||0);
                    }
                    return memo;
                },setObj);
            }
            return setObj;
        },
        
        healthHandler = function(attributes){
            return _.reduce(['sp','hp','rp'],(memo,h)=>{
                TAS.log('memo: '+JSON.stringify(memo));
                TAS.log(attributes[h]);
                memo.health_status+=(attributes[h]*1 <= 0 ? 1 : 0);
                TAS.log('memo: '+JSON.stringify(memo));
                return memo;
            },{health_status:0})
        },
        
        acHandler = function(attributes,bonus,changed){
            var ac = changed.replace(/_ability/,''),
                setObj = {};
            
            setObj[ac]=10+attributes[attributes[ac+'_ability']]*1+(attributes[ac+'_armor']*1||0)+(bonus[ac]*1||0)
            setObj[ac+'_change']=(bonus[ac] > 1 ? 1 : (bonus[ac] < 1 ? -1 : 0));
            setObj[ac+'_armor_change']=(bonus[ac+'_armor_change'] > 1 ? 1 : (bonus[ac+'_armor_change'] < 1 ? -1 : 0));
            if(ac==='kac'){
                setObj.cmd=setObj[ac]+(bonus.cmd*1||0);
                setObj.cmd_change=(bonus.cmd > 1 ? 1 : (bonus.cmd < 1 ? -1 : 0));
            }
            return setObj;
        },
        
        saveHandler = function(attributes,bonus,changed){
            var save = changed.replace(/_ability/,''),
                setObj = {};
            
            setObj[save]=attributes[attributes[save+'_ability']]*1+attributes[save+'_base']*1+(bonus[save]*1||0);
            setObj[save+'_change']=(bonus[save] > 1 ? 1 : (bonus[save] < 1 ? -1 : 0));
            return setObj;
        },
        
        initiativeHandler = function(attributes,bonus){
            return {initiative:attributes[attributes.initiative_ability]*1 + (bonus['initiative']*1||0)};
        },
        
        skillHandler = function(attributes,bonus,changed){
            var skill = changed.replace(/_(?:ranks|ability|class_skill)/,''),
                setObj={};
                
            setObj[skill]=(attributes[skill+'_ranks']*1||0)+(attributes[skill+'_ranks']*1 > 0 ? (attributes[skill+'_class_skill']*1||0) : 0)+(attributes[attributes[skill+'_ability']]*1||0)+(bonus[skill]||0);
            return setObj;
        },
        
        equipmentHandler = function(attributes,bonus,changed){
            
        },
        
        attackHandler = function(attributes,bonus,changed){
            
        },
        
        bootup = function(){
            TAS.log('Starfinder Character Sheet v'+version+' loaded');
        };
        return {
            Bootup: bootup,
        	RegisterEventHandlers: RegisterEventHandlers
	    };
    }());
    starfinder.Bootup();
    starfinder.RegisterEventHandlers();
    /*end of starfinder.js*/
</script>
